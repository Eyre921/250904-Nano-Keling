# **产品需求文档 (PRD): AI商品视频智能生成器**

|**文档版本**|2.0 (最终版)|
|---|---|
|**创建日期**|2025年9月4日|
|**项目名称**|AI商品视频智能生成器 (AI Product Video Smart Generator)|
|**创建人**|Gemini|

### **1. 项目概述 (Overview)**

#### **1.1 项目背景**

在当前的电商和数字营销领域，短视频已成为吸引用户、提升转化率的关键内容形式。然而，对于许多中小型商家、设计师或个人创作者而言，制作高质量的商品展示视频面临着技术门槛高、制作周期长、成本昂贵等痛点。他们通常拥有商品图片，但缺乏将其转化为动态视频的便捷工具。

#### **1.2 产品简介**

本项目旨在开发一个一站式Web应用，利用前沿的AI技术，赋能用户将静态的商品图片轻松、快速地转化为富有创意的动态短视频。用户只需上传在普通环境下拍摄的商品图，系统将通过AI自动完成图像背景去除，并允许用户选择首尾关键帧，结合自定义的文本提示（Prompt），最终生成一段完整的商品展示视频。

#### **1.3 解决的核心问题**

- **降低视频制作门槛**: 让没有专业视频编辑技能的用户也能制作出色的产品视频。
    
- **提升内容生产效率**: 将数小时甚至数天的工作流程缩短到几分钟。
    
- **降低营销成本**: 提供一个比传统视频制作和外包服务成本效益更高的替代方案。
    

### **2. 产品目标 (Goals & Objectives)**

- **业务目标**: 打造一个在电商营销领域内，简单、高效、智能的AI视频内容创作工具。
    
- **用户目标**: 为用户提供一个流畅的工作流，从图片上传到视频生成，全程体验无缝且直观。
    
- **技术目标**: 成功集成图像处理AI（如Gemini）和视频生成AI（如可灵），并保证服务的稳定、可配置与响应。
    

### **3. 目标用户 (Target Audience)**

|用户画像|描述|痛点|
|---|---|---|
|**小张**|28岁，电商卖家|经营着一家小型在线饰品店，自己负责上新、拍照和营销。希望为每个新品制作独特的展示短视频，但不会使用AE/Pr等专业软件，外包制作费用高昂。|
|**Lisa**|35岁，市场营销专员|在一家中型消费品公司工作，需要为社交媒体渠道批量产出产品宣传物料。希望有一个工具能快速将产品图转化为多版本的视频广告以进行A/B测试。|
|**阿明**|22岁，设计系学生/自由职业者|经常接一些为产品制作展示效果图或动画的零散项目。希望有一个工具能激发创意，并快速生成视频demo给客户看。|

### **4. 功能需求 (Functional Requirements)**

#### **4.1 用户故事 (User Stories)**

|编号|角色|我想要...|以便...|优先级|
|---|---|---|---|---|
|US-01|作为用户|一次性上传多张在正常环境下拍摄的商品照片。|提高处理效率，不用一张张单独操作。|**高**|
|US-02|作为用户|系统能自动帮我移除上传照片的背景，生成干净的商品主体图。|我可以得到用于视频制作的标准化素材。|**高**|
|US-03|作为用户|在一个清晰的列表中看到所有处理完成的干净图片。|方便我预览和选择。|**高**|
|US-04|作为用户|从图片列表中选择两张图片，并将它们添加到“视频制作区”。|设定视频的开始帧和结束帧。|**高**|
|US-05|作为用户|在一个文本框中自由输入或修改用于指导视频生成的提示词 (Prompt)。|精确控制视频的风格、动态效果和内容。|**高**|
|US-06|作为用户|将我常用的或效果好的提示词保存起来，并给它起一个自定义的名字。|未来可以快速复用，不用重复输入。|**中**|
|US-07|作为用户|通过选择我自定义的名字，一键调用之前保存好的提示词。|进一步提升我的工作效率。|**中**|
|US-08|作为用户|在设置区域自定义我所使用的AI模型和API凭证（Keys）。|使用我自己的AI服务配额，或切换不同的模型版本。|**高**|
|US-09|作为用户|首次加载网页时，系统能自动预填我的模型和API凭证（如果已配置）。|无需每次都手动输入，简化操作。|**中**|

### **5. 非功能性需求 (Non-Functional Requirements)**

|类别|需求描述|
|---|---|
|**性能 (Performance)**|- 页面首次加载时间应在3秒以内。 - 图片上传和处理过程应有明确的进度反馈，避免用户因等待而焦虑。 - 视频生成是耗时操作，需明确告知用户预计时间或提供任务状态查询。|
|**易用性 (Usability)**|- 界面布局清晰，工作流（上传->处理->选择->生成）引导明确。 - 所有可点击的元素都有清晰的视觉反馈（如悬停、点击效果）。|
|**安全性 (Security)**|- 用户的API Key、Access Key、Secret Key **绝对不能**在前端代码中暴露或存储，必须由后端进行安全管理和使用。 - 所有用户上传的文件在处理后应有合理的清理机制，保护用户隐私。|
|**兼容性 (Compatibility)**|- 优先支持主流现代桌面浏览器：Chrome, Firefox, Safari, Edge的最新版本。|

### **6. 技术规格与API定义 (Technical Specifications & API Definitions)**

#### **6.1 系统架构**

采用前后端分离架构。前端 (JavaScript) 负责用户交互与界面展示；后端 (Python/Node.js) 负责业务逻辑、AI服务调度、安全认证和数据管理。所有AI服务的具体信息由一个外部配置文件 `services_config.json` 驱动。

#### **6.2 服务配置文件 (`services_config.json`)**

系统核心配置文件，V1版本预置Nano Banana和可灵服务。

```
{
  "image_processing_services": [
    {
      "id": "nano_banana_remove_bg_v1",
      "name": "Nano Banana (Gemini 抠图)",
      "api_endpoint": "[https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-image-preview:generateContent](https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-image-preview:generateContent)",
      "default_model": "gemini-2.5-flash-image-preview",
      "auth": {
        "type": "api_key_query_param",
        "key_name": "key"
      },
      "payload_template": {
        "contents": [
          {
            "parts": [
              { "text": "Remove the background from this product image, keeping only the main product. The background must be transparent." },
              { "inline_data": { "mime_type": "{{mime_type}}", "data": "{{base64_image}}" } }
            ]
          }
        ]
      }
    }
  ],
  "video_generation_services": [
    {
      "id": "kling_image2video_v1",
      "name": "可灵 AI (首尾帧生视频)",
      "api_endpoint_base": "[https://api-beijing.klingai.com](https://api-beijing.klingai.com)",
      "default_model": "kling-v1",
      "auth": {
        "type": "jwt_bearer_header",
        "header_name": "Authorization"
      },
      "endpoints": {
        "create_task": "/v1/videos/image2video",
        "query_task": "/v1/videos/image2video/"
      },
      "payload_template": {
        "model_name": "{{model}}",
        "prompt": "{{prompt}}",
        "image": "{{base64_start_frame}}",
        "image_tail": "{{base64_end_frame}}",
        "duration": "5",
        "mode": "pro"
      }
    }
  ]
}

```

#### **6.3 认证流程 (Authentication Flow)**

后端必须能够根据`services_config.json`中的`auth.type`处理不同的认证方式：

- **`api_key_query_param`**: 后端直接将用户提供的API Key作为URL查询参数附加到请求上。
    
- **`jwt_bearer_header`**:
    
    1. 后端从用户设置中获取`AccessKey`和`SecretKey`。
        
    2. 每次调用可灵API前，后端**必须**使用JWT标准生成一个有效期为30分钟的临时API Token。
        
    3. 将生成的Token组装成`Bearer <token>`的形式，并放入HTTP请求的`Authorization`头中。
        

#### **6.4 核心工作流详述**

- **A. 图像背景去除 (同步流程)**
    
    1. **前端**: 发送图片Base64、服务ID (`nano_banana_remove_bg_v1`) 和API Key至后端。
        
    2. **后端**: 根据配置构建请求，直接调用Gemini API，等待返回结果，并将处理后的图片数据回传给前端。
        
- **B. 首尾帧生成视频 (异步轮询流程)**
    
    1. **前端**: 发送首尾帧Base64、Prompt、服务ID (`kling_image2video_v1`)、Access Key和Secret Key至后端。
        
    2. **后端 (创建任务)**: 生成JWT Token，调用可灵的`create_task`接口。成功后，将返回的`task_id`回传给前端。
        
    3. **前端 (轮询状态)**: 接收到`task_id`后，启动定时器，每10秒调用一次后端的`GET /api/video-status/{task_id}`接口。
        
    4. **后端 (查询任务)**: 接收到前端轮询请求后，生成新的JWT Token，调用可灵的`query_task`接口 (`GET /v1/videos/image2video/{task_id}`) 查询任务状态。
        
    5. **结果返回**:
        
        - 若状态为`processing`或`submitted`，返回"处理中"。
            
        - 若状态为`succeed`，提取视频URL并返回"成功"及URL。前端停止轮询并展示视频。
            
        - 若状态为`failed`，返回"失败"及原因。前端停止轮询并显示错误。
            

### **7. 错误处理与用户反馈 (Error Handling & User Feedback)**

#### **7.1 错误码映射与用户提示**

后端在接收到来自AI服务的错误时，应根据下表映射成对用户友好的提示信息返回给前端。

|HTTP|业务码|触发场景|后端行为/策略|前端显示信息|
|---|---|---|---|---|
|401|1000-1004|身份验证失败|直接返回错误|"认证失败: API Key或Token无效，请检查您的设置。"|
|429|1101|账户欠费|直接返回错误|"处理失败: AI服务商提示账户欠费，请充值。"|
|429|1102|资源包耗尽|直接返回错误|"处理失败: AI服务商提示资源包已用尽或过期。"|
|403|1103|无权限|直接返回错误|"处理失败: 您的账户无权使用该模型或接口。"|
|400|1201|参数非法|直接返回错误|"系统错误: 请求参数不合法，请联系技术支持。"|
|400|1301|内容安全|直接返回错误|"处理失败: 您的图片或提示词可能包含不适宜内容，请修改后重试。"|
|429|1302|请求过快|**执行指数退避重试 (3次)**。若仍失败则返回错误。|(重试时) "请求繁忙，正在重试..." (最终失败时) "处理失败: AI服务繁忙，请稍后再试。"|
|500+|5000-5002|服务器内部错误|**执行指数退避重试 (3次)**。若仍失败则返回错误。|(重试时) "服务不稳定，正在重试..." (最终失败时) "处理失败: AI服务提供商服务器内部错误，请稍后再试。"|

#### **7.2 状态显示**

前端必须清晰地向用户传达当前系统的状态：

- **空闲状态**: 显示操作指引。
    
- **上传/处理中**: 显示进度条或加载动画 (Spinner)，并禁用相关操作按钮。
    
- **成功**: 显示成功提示（如Toast或打勾图标），并展示结果。
    
- **失败**: 显示清晰的错误信息横幅或弹窗，内容来自**7.1**节的“前端显示信息”。
    

### **8. 未来范围 (Out of Scope for V1.0)**

以下功能在当前版本中**不予考虑**，但可能作为未来迭代的方向：

- 用户账户系统和历史项目管理。
    
- 视频在线剪辑、添加背景音乐或水印的功能。
    
- 支持选择多于2个关键帧以控制视频中间过程。
    
- 提供预设的提示词模板库。
    
- 移动端适配。